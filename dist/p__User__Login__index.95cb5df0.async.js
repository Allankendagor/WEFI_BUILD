"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[366],{64752:function(Y,E,a){a.d(E,{S:function(){return T}});var b=a(15009),c=a.n(b),O=a(99289),v=a.n(O),U=a(5574),M=a.n(U),N=a(67294),R=a(85893),T=(0,N.createContext)({token:null,setToken:function(){}}),z=function(Z){var S=Z.children,G=useState(localStorage.getItem("awesomeleadstoken")),A=_slicedToArray(G,2),m=A[0],x=A[1];return useEffect(function(){var L=function(){var k=_asyncToGenerator(_regeneratorRuntime().mark(function I(){var j,F,C;return _regeneratorRuntime().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(!m){s.next=25;break}return s.prev=1,j={method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(m)}},s.next=5,fetch("http://52.206.183.121:8000/login",j);case 5:if(F=s.sent,F.ok){s.next=13;break}console.log("Token:",m),console.error("Error fetching user data:",F.status),x(null),localStorage.removeItem("awesomeleadstoken"),s.next=18;break;case 13:return console.log("Token:",m),s.next=16,F.json();case 16:C=s.sent,console.log("User data:",C);case 18:s.next=25;break;case 20:s.prev=20,s.t0=s.catch(1),console.error("Error fetching user data:",s.t0),x(null),localStorage.removeItem("awesomeleadstoken");case 25:case"end":return s.stop()}},I,null,[[1,20]])}));return function(){return k.apply(this,arguments)}}();L()},[m]),useEffect(function(){m?localStorage.setItem("awesomeleadstoken",m):localStorage.removeItem("awesomeleadstoken")},[m]),_jsx(T.Provider,{value:{token:m,setToken:x},children:S})}},11053:function(Y,E,a){a.r(E),a.d(E,{default:function(){return oe}});var b=a(15009),c=a.n(b),O=a(97857),v=a.n(O),U=a(99289),M=a.n(U),N=a(5574),R=a.n(N),T=a(57426),z=a(2618),t=a(35312);function Z(p,n){return S.apply(this,arguments)}function S(){return S=M()(c()().mark(function p(n,i){return c()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.abrupt("return",(0,t.request)("/api/login/captcha",v()({method:"GET",params:v()({},n)},i||{})));case 1:case"end":return y.stop()}},p)})),S.apply(this,arguments)}var G=a(52218),A=a(60174),m=a(24126),x=a(87547),L=a(94149),k=a(24454),I=a(35763),j=a(5966),F=a(16434),C=a(63434),H=a(40056),s=a(2453),_=a(87223),q=a(67610),W=a(67294),ee=a(73935),ae=a(44023),se=a(64752),e=a(85893),K=(0,ae.kc)(function(p){var n=p.token;return{action:{marginLeft:"8px",color:"rgba(0, 0, 0, 0.2)",fontSize:"24px",verticalAlign:"middle",cursor:"pointer",transition:"color 0.3s","&:hover":{color:n.colorPrimaryActive}},lang:{width:42,height:42,lineHeight:"42px",position:"fixed",right:16,borderRadius:n.borderRadius,":hover":{backgroundColor:n.colorBgTextHover}},container:{display:"flex",flexDirection:"column",height:"100vh",overflow:"auto",backgroundImage:"url('https://mdn.alipayobjects.com/yuyan_qk0oxh/afts/img/V-_oS6r-i7wAAAAAAAAAAAAAFl94AQBr')",backgroundSize:"100% 100%"}}}),te=function(){var n=K(),i=n.styles;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(G.Z,{className:i.action},"AlipayCircleOutlined"),(0,e.jsx)(A.Z,{className:i.action},"TaobaoCircleOutlined"),(0,e.jsx)(m.Z,{className:i.action},"WeiboCircleOutlined")]})},re=function(){var n=K(),i=n.styles;return(0,e.jsx)("div",{className:i.lang,"data-lang":!0,children:t.SelectLang&&(0,e.jsx)(t.SelectLang,{})})},V=function(n){var i=n.content;return(0,e.jsx)(H.Z,{style:{marginBottom:24},message:i,type:"error",showIcon:!0})},ne=function(){var n=(0,W.useState)({}),i=R()(n,2),$=i[0],y=i[1],le=(0,W.useState)("account"),w=R()(le,2),D=w[0],ue=w[1],Q=(0,t.useModel)("@@initialState"),P=Q.initialState,ie=Q.setInitialState,de=K(),ge=de.styles,l=(0,t.useIntl)(),ce=(0,W.useContext)(se.S),pe=ce.setToken,me=function(){var h=M()(c()().mark(function u(){var d,g;return c()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,P==null||(d=P.fetchUserInfo)===null||d===void 0?void 0:d.call(P);case 2:g=r.sent,g&&(0,ee.flushSync)(function(){ie(function(B){return v()(v()({},B),{},{currentUser:g})})});case 4:case"end":return r.stop()}},u)}));return function(){return h.apply(this,arguments)}}(),fe=function(){var h=M()(c()().mark(function u(d){var g,f,r,B;return c()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,(0,z.x4)(v()(v()({},d),{},{type:D}));case 3:if(g=o.sent,!g.access_token){o.next=13;break}return f=l.formatMessage({id:"pages.login.success",defaultMessage:"Login Successful"}),s.ZP.success(f),localStorage.setItem("awesomeleadstoken",g.access_token),o.next=10,me();case 10:return r=new URL(window.location.href).searchParams,t.history.push(r.get("redirect")||"/"),o.abrupt("return");case 13:y(g),o.next=21;break;case 16:o.prev=16,o.t0=o.catch(0),B=l.formatMessage({id:"pages.login.failure",defaultMessage:"Login failed, please try again"}),console.log(o.t0),s.ZP.error(B);case 21:case"end":return o.stop()}},u,null,[[0,16]])}));return function(d){return h.apply(this,arguments)}}(),X=$.status,J=$.type;return(0,e.jsxs)("div",{className:ge.container,children:[(0,e.jsx)(t.Helmet,{children:(0,e.jsxs)("title",{children:[l.formatMessage({id:"menu.login",defaultMessage:"\u767B\u5F55\u9875"}),"- ",q.Z.title]})}),(0,e.jsx)(re,{}),(0,e.jsx)("div",{style:{flex:"1",padding:"32px 0"},children:(0,e.jsxs)(I.U,{contentStyle:{minWidth:280,maxWidth:"75vw"},logo:(0,e.jsx)("img",{alt:"logo",src:"/logo1.png"}),title:"WEFI",subTitle:l.formatMessage({id:"pages.layouts.userLayout.title"}),initialValues:{autoLogin:!0},actions:[(0,e.jsx)(t.FormattedMessage,{id:"pages.login.loginWith",defaultMessage:"\u5176\u4ED6\u767B\u5F55\u65B9\u5F0F"},"loginWith"),(0,e.jsx)(te,{},"icons")],onFinish:function(){var h=M()(c()().mark(function u(d){return c()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,fe(d);case 2:case"end":return f.stop()}},u)}));return function(u){return h.apply(this,arguments)}}(),children:[(0,e.jsx)(_.Z,{activeKey:D,onChange:ue,centered:!0,items:[{key:"account",label:l.formatMessage({id:"pages.login.accountLogin.tab",defaultMessage:"\u8D26\u6237\u5BC6\u7801\u767B\u5F55"})},{key:"mobile",label:l.formatMessage({id:"pages.login.phoneLogin.tab",defaultMessage:"\u624B\u673A\u53F7\u767B\u5F55"})}]}),X==="error"&&J==="account"&&(0,e.jsx)(V,{content:l.formatMessage({id:"pages.login.accountLogin.errorMessage",defaultMessage:"\u8D26\u6237\u6216\u5BC6\u7801\u9519\u8BEF(admin/ant.design)"})}),D==="account"&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(j.Z,{name:"username",fieldProps:{size:"large",prefix:(0,e.jsx)(x.Z,{})},placeholder:l.formatMessage({id:"pages.login.username.placeholder",defaultMessage:"\u7528\u6237\u540D: admin or user"}),rules:[{required:!0,message:(0,e.jsx)(t.FormattedMessage,{id:"pages.login.username.required",defaultMessage:"\u8BF7\u8F93\u5165\u7528\u6237\u540D!"})}]}),(0,e.jsx)(j.Z.Password,{name:"password",fieldProps:{size:"large",prefix:(0,e.jsx)(L.Z,{})},placeholder:l.formatMessage({id:"pages.login.password.placeholder",defaultMessage:"\u5BC6\u7801: ant.design"}),rules:[{required:!0,message:(0,e.jsx)(t.FormattedMessage,{id:"pages.login.password.required",defaultMessage:"\u8BF7\u8F93\u5165\u5BC6\u7801\uFF01"})}]})]}),X==="error"&&J==="mobile"&&(0,e.jsx)(V,{content:"\u9A8C\u8BC1\u7801\u9519\u8BEF"}),D==="mobile"&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(j.Z,{fieldProps:{size:"large",prefix:(0,e.jsx)(k.Z,{})},name:"mobile",placeholder:l.formatMessage({id:"pages.login.phoneNumber.placeholder",defaultMessage:"\u624B\u673A\u53F7"}),rules:[{required:!0,message:(0,e.jsx)(t.FormattedMessage,{id:"pages.login.phoneNumber.required",defaultMessage:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7\uFF01"})},{pattern:/^1\d{10}$/,message:(0,e.jsx)(t.FormattedMessage,{id:"pages.login.phoneNumber.invalid",defaultMessage:"\u624B\u673A\u53F7\u683C\u5F0F\u9519\u8BEF\uFF01"})}]}),(0,e.jsx)(F.Z,{fieldProps:{size:"large",prefix:(0,e.jsx)(L.Z,{})},captchaProps:{size:"large"},placeholder:l.formatMessage({id:"pages.login.captcha.placeholder",defaultMessage:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801"}),captchaTextRender:function(u,d){return u?"".concat(d," ").concat(l.formatMessage({id:"pages.getCaptchaSecondText",defaultMessage:"\u83B7\u53D6\u9A8C\u8BC1\u7801"})):l.formatMessage({id:"pages.login.phoneLogin.getVerificationCode",defaultMessage:"\u83B7\u53D6\u9A8C\u8BC1\u7801"})},name:"captcha",rules:[{required:!0,message:(0,e.jsx)(t.FormattedMessage,{id:"pages.login.captcha.required",defaultMessage:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801\uFF01"})}],onGetCaptcha:function(){var h=M()(c()().mark(function u(d){var g;return c()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Z({phone:d});case 2:if(g=r.sent,g){r.next=5;break}return r.abrupt("return");case 5:s.ZP.success("\u83B7\u53D6\u9A8C\u8BC1\u7801\u6210\u529F\uFF01\u9A8C\u8BC1\u7801\u4E3A\uFF1A1234");case 6:case"end":return r.stop()}},u)}));return function(u){return h.apply(this,arguments)}}()})]}),(0,e.jsxs)("div",{style:{marginBottom:24},children:[(0,e.jsx)(C.Z,{noStyle:!0,name:"autoLogin",children:(0,e.jsx)(t.FormattedMessage,{id:"pages.login.rememberMe",defaultMessage:"\u81EA\u52A8\u767B\u5F55"})}),(0,e.jsx)("a",{style:{float:"right"},children:(0,e.jsx)(t.FormattedMessage,{id:"pages.login.forgotPassword",defaultMessage:"\u5FD8\u8BB0\u5BC6\u7801"})})]})]})}),(0,e.jsx)(T.$_,{})]})},oe=ne}}]);
